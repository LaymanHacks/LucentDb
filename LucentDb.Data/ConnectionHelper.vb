'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated by a tool.
'     Generated by Merlin Version: 1.0.0.0
'
'     Changes to this file may cause incorrect behavior and will be lost if 
'     the code is regenerated.
' </autogenerated>
'------------------------------------------------------------------------------

Imports System.Configuration

Namespace LucentDb.Data
    Public NotInheritable Class DbConnectionHelper
        Private Sub New()
        End Sub

        Public Shared Function GetConnectionHolder(connectionName As String) As DbConnectionHolder

            Dim holder As New DbConnectionHolder(connectionName)
            Dim closeConn As Boolean = True
            Try
                Try
                    holder.Open()
                    closeConn = False
                Finally
                    If closeConn Then
                        holder.Close()
                        holder = Nothing
                    End If
                End Try
            Catch
                Throw
            End Try
            Return holder
        End Function

        Public Shared Function GetConnectionString(connectionStringName As String) As String
            If connectionStringName Is Nothing OrElse connectionStringName.Length < 1 Then
                Return Nothing
            End If

            Dim connectionString As String = Nothing

            Dim connObj As ConnectionStringSettings = ConfigurationManager.ConnectionStrings(connectionStringName)
            If connObj IsNot Nothing Then
                connectionString = connObj.ConnectionString
            End If

            If connectionString Is Nothing Then
                Return Nothing
            End If

            Return connectionString
        End Function
    End Class
End Namespace
